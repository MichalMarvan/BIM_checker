<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="parser.title"></title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/ids-parser.css">
    <link rel="stylesheet" href="../assets/css/ids-editor-styles.css">
</head>
<body>
    <div class="page-container">
        <div class="header">
            <a href="../index.html" class="back-home-btn" data-i18n="btn.back">â† DomÅ¯</a>
            <div class="language-switcher">
                <button class="lang-btn active" data-lang="cs">CZ</button>
                <button class="lang-btn" data-lang="en">EN</button>
            </div>
            <h1 data-i18n="parser.title">ğŸ” IDS Parser a VizualizÃ©r</h1>
            <p data-i18n="parser.subtitle">Nahrajte IDS (Information Delivery Specification) soubor pro vizualizaci struktury</p>
        </div>

        <div class="upload-section">
            <div class="file-upload" id="fileUploadArea">
                <div class="file-upload-icon">ğŸ“„</div>
                <h3 data-i18n="parser.dragHint">PÅ™etÃ¡hnÄ›te IDS soubor sem</h3>
                <p data-i18n="parser.clickHint">nebo kliknÄ›te pro vÃ½bÄ›r souboru (.ids, .xml)</p>
                <input type="file" id="fileInput" class="file-input" accept=".ids,.xml">
                <div style="display: flex; gap: 10px; margin-top: 1rem; justify-content: center;">
                    <button class="sample-button" onclick="event.stopPropagation(); loadSampleIDS()" data-i18n="parser.loadSample">NaÄÃ­st ukÃ¡zkovÃ½ IDS</button>
                    <button class="sample-button" style="background: #28a745;" onclick="event.stopPropagation(); openStoragePicker()" data-i18n="parser.loadFromStorage">ğŸ“¦ NaÄÃ­st z ÃºloÅ¾iÅ¡tÄ›</button>
                </div>
            </div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="visualization-section" id="visualizationSection">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 2px solid #e9ecef;">
                <h2 style="margin: 0;" data-i18n="parser.specifications">ğŸ“‹ IDS Specifikace</h2>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('visual')" data-i18n="parser.tabVisual">ğŸ“Š VizuÃ¡lnÃ­ zobrazenÃ­</button>
                <button class="tab" onclick="switchTab('tree')" data-i18n="parser.tabTree">ğŸŒ³ StromovÃ¡ struktura</button>
                <button class="tab" onclick="switchTab('editor')" data-i18n="parser.tabEditor">âœï¸ Editor</button>
                <button class="tab" onclick="switchTab('raw')" data-i18n="parser.tabRaw">ğŸ“ Raw XML</button>
            </div>

            <div id="visualTab" class="tab-content active">
                <div class="ids-info" id="idsInfo"></div>
                <div class="specifications-container" id="specificationsContainer"></div>
            </div>

            <div id="treeTab" class="tab-content">
                <div class="tree-view" id="treeView"></div>
            </div>

            <div id="editorTab" class="tab-content">
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #e9ecef;">
                    <button class="btn btn-secondary" id="createNewIdsBtn" data-i18n="parser.createNew">âœ¨ VytvoÅ™it novÃ½ IDS</button>
                    <button class="btn btn-primary" id="toggleEditBtn" data-i18n="parser.editMode">âœï¸ EditaÄnÃ­ reÅ¾im</button>
                    <button class="btn btn-success" id="downloadIdsBtn" data-i18n="parser.download">ğŸ’¾ StÃ¡hnout IDS</button>
                </div>
                <div id="idsContent"></div>
            </div>

            <div id="rawTab" class="tab-content">
                <div class="tree-view">
                    <pre id="rawXML"></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Storage Picker Modal -->
    <div id="idsStorageModal" class="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center; align-items: center;">
        <div class="modal-container" style="background: white; border-radius: 12px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); max-width: 700px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center;">
                <h2 style="margin: 0; font-size: 1.6em;" data-i18n="parser.modalTitle">ğŸ“¦ NaÄÃ­st IDS soubor z ÃºloÅ¾iÅ¡tÄ›</h2>
                <button class="modal-close" onclick="closeIdsStoragePicker()" style="background: rgba(255,255,255,0.2); border: none; color: white; font-size: 1.5em; width: 35px; height: 35px; border-radius: 50%; cursor: pointer;">&times;</button>
            </div>
            <div class="modal-body" style="padding: 30px;">
                <p style="margin-bottom: 15px; color: #6c757d;" data-i18n="parser.selectFile">
                    Vyberte jeden IDS soubor z ÃºloÅ¾iÅ¡tÄ›:
                </p>
                <div id="idsStorageFileTree" style="max-height: 400px; overflow-y: auto; border: 2px solid #e9ecef; border-radius: 8px; padding: 15px; background: #f8f9fa;">
                    <!-- Zde bude stromovÃ¡ struktura souborÅ¯ -->
                </div>
                <div style="margin-top: 15px; padding: 10px; background: #eef2ff; border-radius: 6px;">
                    <strong data-i18n="parser.selectedFile">VybranÃ½ soubor:</strong> <span id="selectedIdsFileName" data-i18n="parser.noFile">Å½Ã¡dnÃ½</span>
                </div>
            </div>
            <div class="modal-footer" style="padding: 20px 30px; border-top: 2px solid #e9ecef; display: flex; justify-content: flex-end; gap: 10px;">
                <button class="btn btn-secondary" onclick="closeIdsStoragePicker()" data-i18n="btn.cancel">ZruÅ¡it</button>
                <button class="btn btn-primary" onclick="loadSelectedIdsFromStorage()" data-i18n="parser.loadFile">NaÄÃ­st soubor</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/js/common/translations.js"></script>
    <script src="../assets/js/common/i18n.js"></script>
    <script src="../assets/js/common/error-handler.js"></script>
    <script src="../assets/js/common/storage.js"></script>
    <script src="../assets/js/ids/ifc-data.js"></script>
    <script src="../assets/js/ids/ids-xml-generator.js"></script>
    <script src="../assets/js/ids/ids-editor-modals.js"></script>
    <script src="../assets/js/ids/ids-editor-core.js"></script>
    <script src="../assets/js/parser.js"></script>
</body>
</html>
